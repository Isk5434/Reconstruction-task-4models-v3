# Reconstruction-task-4models-v3

accuracy  precision    recall   roc_auc    pr_auc  mean_detection_delay評価指標のプロットと正常データ内９５％で異常とみなす閾値の可視化


このコードで分かったことについて。

【SMAPデータにおける NGRC の圧倒的優位】


SMAPの結果を見ると、NGRC（Next-Generation Reservoir Computing） が他のモデル（RNN, LSTM, ESN）に対して明確な差をつけています。
精度の高さ: Precision (0.1507) と Recall (0.0674) が、RNNやLSTMの約2〜3倍のスコアを出しています。
検出の速さ: Mean Detection Delay（平均検出遅延） が 28.29 と、他モデルの約45に比べて圧倒的に短いです。つまり、異常が発生してから検知するまでのタイムラグが最も少ないことを意味します。






次に閾値の可視化です（なんか文字がつぶれてました:melting_face:）

【赤い背景（異常区間）】
実際に異常が発生している区間

【黒い点線（閾値）】
正常データの誤差の95パーセンタイル
これを**閾値（しきい値）**として使っている
正常データの誤差の 95% は“正常として許容する範囲”という意味。
（ここでの「95%」は：train正常データ内での分布）
:point_right: ここを超えたら「異常」と判定（設計思想としては検知できない状況を少なくするために「正常のうち最大5%は“異常扱いになるかもしれない”と許容している）

【カラフルなギザギザ線】
・モデルが出した 予測誤差（MSE）
高いほどモデルが再現できていない（ずれが大きいということ）



良い状態は…

赤い区間（本当の異常）に入ったら誤差がグッと上がり黒い線（閾値）を超える
赤以外ではあまり超えない

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

ダメなパターン
① 誤検知が多い
正常区間でも黒線を頻繁に超える
→ 「うるさい警報機」

② 見逃し
赤い区間なのに黒線を超えない
→ 「壊れてるのに気づかない」

③ 遅すぎる
赤区間に入ってかなり経ってから超える
→ 検知遅延が大きい

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー



赤い区間で

スパイクが黒線を超えていれば → 検知成功
超えていなければ → 見逃し
赤くないところで超えていれば → 誤検知


だそうです。赤い区間の中でも

大きなスパイクがある場所
ほとんど変化がない場所
両方ある場合、異常区間内でも、常に大きな誤差が出るとは限らないそう。

つまり赤い区間は
:man-gesturing-ok:物理的に異常が発生している時間帯
 :heavy_multiplication_x: すべての時刻が必ず大きな値
という感じです。
